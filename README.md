# EfficientAD
# EfficientAD

1. Git clone this repo using the command --> git clone.
2. Make a directory in this same folder
For eg: XNPS/any dataset name that you want. 
        --> normal (Must contain all good images)
        --> abnormal (Must contain all bad images)
        --> test (This folder will be used to store images to run while inference)
            --> normal
            --> abnormal
3. Create a new environment. In miniforge, you can do this using conda env -n efficientad python=3.10. This will create a new environment called efficientad(the -n is for name of environment. You can keep any name) with a python version 3.10. I recommend keeping the version at 3.10. 
4. Now that you have created an environment, we need to activate it. In miniforge, you can do this using conda activate efficientad. 
5. The next step is to install the libraries required to run the code. Run the following command to do that:
pip install -r requirements.txt 
This will install all the required libraries to run efficientAD.
Sometimes, after you install everything, you might still get some version issue or library missing issue. If you encounter this, deactivate the environment using conda deactivate. Then remove the environment using conda remove -n efficientad --all. This will remove the enviroment alongwith all the packages installed. 

5. Now, we are all set and we can start running the python script. To do this, run the following command:
python -W ignore own_train.py
This will start the training. The -W ignore is used to ignore warnings. 

8. Let us now understand the outputs from the model:
The images folder has the validation results as the model was training. 
The XNPS folder here or, that would be the dataset name, would have 2 folders and a csv file. 
The anomaly_maps has the maps of anomalies in the test dataset. The part where the image is white, is the part where the model thinks there is an anomaly. The brighter the region, the higher the confidence. 
The pred_masks is the folder we need. It has the actual mask generated by the model
The results.csv would have the image path, the pred score(probability of the image being abnormal), pred labels(based on the probability), the paths to the anomaly masks and the mask path(path to the actual mask generated). The box would have an empty tensor if there is no defect in the image, or it would be the coordinated of top left x and y coordinates and bottom right x and y coordinates of the anomaly in the image. 











